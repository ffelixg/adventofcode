data = """LLRLRLLRRLRLRLLRRLRRRLRRRLRRLRRLRLRLRRRLLRLRRLRLRRRLRLLRRLRLRLLRRRLLRLRRRLRLRRLRRLRLLRRLRRLRLRLRLLRLLRRLRRLRRLRRLRRLRLLRLRLRRRLRRRLRRLRLRLRRLRRRLRLRRRLRLRLRLRRRLRRLRRLRRRLLLLRRLRRLRLRRRLRLRRRLRRLLLLRLRLRRRLRRRLRLRRLLRLRLRRRLRLRLRRRLRLLRRRLRRLRLRLRRRLRLLRRLLRRRLRRRLRRRLRRLRLRLRRRLRRRLRRRLLRRRR

NNN = (TNT, XDJ)
GKJ = (TQD, PDP)
VPC = (TST, FDJ)
MNG = (GQS, RVK)
JQF = (LLK, BQH)
HPS = (XDJ, TNT)
VSD = (GNK, HJS)
VGT = (KXR, FMP)
GQB = (GTX, HLC)
PLJ = (QCS, TVN)
BXM = (GMB, LBC)
XJQ = (NHG, NQD)
NKX = (KBJ, GTS)
PKT = (XFK, SKR)
HJB = (LRX, KQG)
SNM = (PLN, CJT)
LQD = (MTK, KMS)
KTN = (SSC, KPL)
LVJ = (CQJ, GPP)
GSV = (SNM, JKK)
CPH = (DCQ, FCP)
TDV = (JFD, HKH)
SBS = (NFC, CGC)
DBG = (GST, LGH)
LHS = (GHG, TRD)
BPP = (DLF, NJT)
TNT = (VNX, PTR)
VTN = (XHM, NMQ)
BRD = (KLF, HXJ)
TJT = (BVD, PFN)
GNK = (NMT, LLX)
DVH = (GQS, RVK)
KRJ = (QSP, TTQ)
KQC = (TNX, MDC)
XVS = (LRC, DLC)
XLP = (XCH, BJQ)
KQG = (LKK, TVP)
QHB = (JPL, JPL)
RGV = (SXB, FKH)
GSK = (JQN, THB)
XDT = (GLG, XKD)
XCT = (MMN, XDM)
KLF = (NPB, RRB)
XLT = (QRB, VHB)
HKS = (NNN, HPS)
NMT = (MSL, VXC)
PML = (NHN, FQH)
FMQ = (HGC, FBH)
JGG = (XTB, XTB)
KMC = (PPS, SVT)
GLG = (SPG, KFK)
QJN = (HJB, QCP)
SGH = (FDV, QPX)
DFM = (BFX, PNS)
CSK = (MDQ, GFX)
MXG = (MXC, BJV)
JTX = (SQN, JBK)
KFN = (VQM, PFH)
SFJ = (KDF, NKB)
JNK = (DLK, LHV)
DTG = (XHQ, DSR)
SHC = (FQV, HKK)
DBM = (VDP, PGK)
PNC = (LMH, RXH)
HXJ = (RRB, NPB)
MKS = (KMX, FKS)
NPA = (TPC, SNK)
LJK = (FPF, SHP)
LBH = (HQB, TTC)
JML = (LTN, SFS)
MXS = (FDL, SXH)
HHV = (VRL, JVC)
NQD = (KVJ, DXM)
HMA = (TVC, RBX)
BCP = (SQD, RGD)
SLP = (CQF, HXG)
KGF = (RPN, PKQ)
TGG = (VQM, PFH)
HQD = (MDV, GND)
BJX = (LCN, QMG)
NBQ = (NSV, VJR)
BBX = (KHG, FDC)
SSQ = (BNQ, MXX)
TST = (MJB, TDV)
JQL = (SDG, DLJ)
TVN = (SJM, KMC)
XHD = (DDG, RSG)
GQA = (NQS, CNH)
QFL = (QSQ, VVN)
THG = (FBM, VQX)
QLZ = (RBX, TVC)
TPM = (DQN, MGG)
QXV = (MTK, KMS)
VNX = (PTP, VSD)
STQ = (XDC, JFR)
XVQ = (PJM, MRN)
XTT = (BHF, RBR)
LQS = (DBB, HNR)
KXG = (FKS, KMX)
XCP = (MXK, DBX)
QRV = (JSK, STC)
VVG = (DRF, QNR)
FTC = (CSK, FPC)
GFV = (VSK, GFQ)
JSM = (LNC, XTF)
LJC = (JFG, XBK)
TQD = (XJQ, MFM)
HJS = (LLX, NMT)
CBP = (PTX, LGD)
LGT = (CTD, CTD)
HMP = (FQJ, KGC)
MSL = (MSD, BFL)
QPX = (QFH, JMK)
KBH = (MGF, TMH)
XMT = (MXC, BJV)
XGR = (KPF, DLH)
RGH = (MBM, KNT)
CDP = (BLG, NVN)
BLG = (TQC, DTD)
MSD = (RVP, RQP)
KXT = (CVM, JQL)
MRN = (MNX, PNC)
RLG = (BNP, VNR)
PSH = (XQG, SLP)
XTF = (NTT, VGT)
KVJ = (JVX, HPJ)
PGF = (KRJ, CRS)
VSV = (NKQ, PJG)
TLV = (QHJ, GFG)
BNP = (NFR, PGR)
XQG = (CQF, HXG)
KGC = (FKF, KCS)
HQF = (QPX, FDV)
PFN = (JGX, FMQ)
HFD = (DBG, CBD)
KQZ = (HXJ, KLF)
HPM = (VSV, LTR)
FGX = (SVR, GQB)
SGJ = (THB, JQN)
NKK = (QHB, QHB)
FLF = (RLC, MXP)
SRV = (QHM, LQS)
NPB = (BPG, CVQ)
VNR = (NFR, PGR)
FNF = (TXL, CXT)
PTB = (QXQ, BDK)
BXN = (HQF, SGH)
RGT = (MGN, GFN)
FSP = (VRK, QNN)
GHT = (PML, HTJ)
CBD = (LGH, GST)
LMH = (TJC, DNN)
PTP = (GNK, HJS)
XDC = (GHT, JTR)
HTJ = (NHN, FQH)
XFK = (NKX, HTV)
PBP = (CJJ, GKS)
KMX = (XSJ, PMK)
CVQ = (FKX, GXP)
SFV = (MXS, FLR)
BQH = (VMH, PKT)
NFR = (RTX, SBJ)
KCS = (XGR, JXT)
GND = (SFJ, DGL)
DTF = (JCC, LVC)
KLM = (XLP, QRQ)
VQV = (DNC, SST)
NKF = (KFN, TGG)
CJT = (LDP, QKM)
NPF = (TNC, LXF)
MHK = (MLX, NHX)
LGD = (DLP, CNJ)
MLF = (QKK, QRK)
LQB = (NKJ, SHN)
SNS = (KMV, HCG)
VPN = (HFV, LNX)
XTB = (XLT, VRF)
LNX = (HFB, QVF)
XGF = (NRN, KCF)
PNS = (JNQ, MCT)
BJG = (DNC, SST)
PQN = (SCL, VPX)
NGQ = (DGT, RLF)
GGX = (LQS, QHM)
VVT = (MHK, LTJ)
QJH = (XTF, LNC)
BBP = (FNX, RTK)
DDP = (JBR, KLD)
GDV = (KXT, BJT)
GDT = (CFB, PSH)
LGH = (CRK, SCF)
JNB = (DXQ, FBK)
DLH = (XJD, GDT)
NCQ = (MXP, RLC)
LXP = (SPR, RTF)
GRQ = (FNX, RTK)
KBJ = (DNB, TDP)
LXK = (CTD, JML)
DBB = (TJD, FNF)
RBR = (JTX, XKN)
GPD = (LXN, PLD)
JNM = (QRM, MSV)
LNC = (VGT, NTT)
GVT = (VVN, QSQ)
KCD = (GFB, MFL)
HDG = (VFQ, DTF)
RGD = (GGX, SRV)
KJK = (SRJ, QGV)
DSL = (MNG, DVH)
DSR = (VQV, BJG)
NHB = (HPS, NNN)
JVX = (JRT, GDQ)
TGB = (DCG, VXK)
MXN = (PST, GBF)
CTP = (XGM, SFV)
BPG = (GXP, FKX)
HRT = (LXF, TNC)
SST = (HDG, VJS)
PDP = (XJQ, MFM)
BDK = (TFM, GRM)
PPS = (RQV, BXN)
SSS = (TJQ, GNQ)
TXL = (QRV, PPH)
RRQ = (RXF, PGF)
PSX = (LLM, FXM)
FBK = (JDQ, DSX)
JLR = (LSM, NXT)
SPR = (DTG, RKQ)
PGC = (TJT, HXC)
LLD = (LHS, RLV)
NRH = (XBB, FGX)
SXH = (HMP, LSK)
JVC = (MLN, XKM)
MGF = (GGT, XMS)
TTS = (TNX, TNX)
FCP = (PLJ, KND)
LRX = (TVP, LKK)
VKJ = (PGN, XPX)
VRL = (XKM, MLN)
RQV = (SGH, HQF)
CRS = (QSP, TTQ)
BJC = (FCJ, TSC)
CSP = (BNM, FLN)
XHQ = (BJG, VQV)
CRK = (DKC, QQQ)
HFB = (BVM, VMP)
SQN = (QJN, KKV)
DGK = (FVX, RGT)
HTP = (HCF, HFR)
RFT = (NMF, DRL)
TRJ = (SHN, NKJ)
XJD = (PSH, CFB)
FQJ = (FKF, KCS)
VHB = (KDM, DSB)
SKR = (NKX, HTV)
LCN = (TLV, FMC)
MTC = (PST, GBF)
QRK = (XNR, SPD)
TCK = (MDK, BCP)
DNN = (HHV, MVS)
JNQ = (PBP, VDG)
NKQ = (MKX, HVD)
FTV = (MNG, DVH)
SJM = (SVT, PPS)
KCB = (NKK, CNF)
KJN = (PRV, BVK)
PRV = (SVP, FTM)
HFV = (HFB, QVF)
NFC = (FVC, TBN)
LMC = (QRK, QKK)
KNF = (CHN, GFV)
XNP = (SGJ, GSK)
QQB = (MLF, LMC)
CVM = (DLJ, SDG)
RSG = (LBH, TLD)
PGR = (RTX, SBJ)
VTD = (QGV, SRJ)
LBC = (PRH, CSP)
RKX = (NHL, XMM)
MXK = (XJN, PTB)
MJD = (DLC, LRC)
GDR = (FCX, KNF)
VXK = (THG, BPN)
GPP = (NRC, DHQ)
SDN = (FKH, SXB)
KJH = (BJX, VHX)
RNQ = (DNX, GPL)
VQX = (RXP, SSS)
PPH = (JSK, STC)
KKV = (HJB, QCP)
ZZZ = (FGX, XBB)
PTN = (KCD, HPQ)
GMP = (KHG, FDC)
NTT = (KXR, FMP)
GBF = (KXG, MKS)
VPX = (JFB, HSN)
SVG = (BPP, RPK)
PJG = (MKX, HVD)
HNR = (TJD, FNF)
XBB = (SVR, GQB)
FBM = (SSS, RXP)
RTX = (QJQ, KJN)
MSV = (KQH, LRF)
MGN = (LGT, LXK)
QDH = (CFV, DHZ)
NPR = (GDR, DCF)
HSN = (VLG, QNC)
PTM = (VGG, CQX)
VCP = (BCL, XDT)
LBP = (MPD, MPD)
NRK = (NNL, XKC)
QCT = (BBL, SVH)
RPL = (MMH, CDP)
RXH = (TJC, DNN)
DGL = (KDF, NKB)
GTQ = (PGF, RXF)
FXG = (BGH, MTH)
FQH = (VCJ, HPM)
LTN = (SCP, SCP)
JMK = (LPX, JNM)
SCL = (JFB, HSN)
TKV = (XHC, HQD)
BDT = (TTS, KQC)
MXX = (SKB, LPC)
RPN = (QJK, BXM)
MFL = (NDC, TPM)
DXM = (HPJ, JVX)
QXM = (LHS, RLV)
QHM = (HNR, DBB)
QRB = (KDM, DSB)
JMG = (PLD, LXN)
QSQ = (BNS, XNC)
CXA = (XLT, VRF)
MXC = (LQD, QXV)
CNJ = (QQP, PXV)
BPM = (BRD, BRD)
BFV = (FCJ, TSC)
KPL = (RPL, HBT)
JJR = (QNN, VRK)
KHG = (VDS, LKJ)
DRC = (HFR, HCF)
DLF = (RFT, STN)
GKS = (QQB, RLT)
TBD = (LFP, PQN)
XNC = (QBD, DDP)
TGC = (JNB, JXF)
KCF = (LBP, JHT)
NKB = (CCJ, RGH)
NPH = (JQF, QJC)
BJQ = (LJC, QMT)
GTS = (TDP, DNB)
XSJ = (KTN, VXJ)
QXQ = (GRM, TFM)
FCJ = (FKJ, DSK)
FPF = (CQH, HML)
VCJ = (LTR, VSV)
QJK = (LBC, GMB)
PMK = (VXJ, KTN)
FXM = (BNT, VVG)
DDG = (TLD, LBH)
MDB = (FDJ, TST)
BSF = (VXK, DCG)
BVK = (FTM, SVP)
RTG = (JSH, LKD)
BPN = (VQX, FBM)
BJT = (CVM, JQL)
DFS = (BCP, MDK)
GRM = (MDB, VPC)
TRD = (NRK, HPF)
FKH = (XHD, SNT)
LXF = (BDX, TKV)
JBK = (KKV, QJN)
JBP = (BNP, VNR)
PKF = (BJX, VHX)
DLK = (DGK, XST)
TFM = (MDB, VPC)
VDP = (VVR, MHR)
RDP = (VJR, NSV)
PTX = (CNJ, DLP)
DCG = (THG, BPN)
BCV = (LTJ, MHK)
FKJ = (NBQ, RDP)
PHK = (KGF, SBX)
JDQ = (PTN, RFF)
TNC = (BDX, TKV)
KCJ = (RPK, BPP)
DLJ = (FTC, TGF)
FQG = (GVT, QFL)
LFP = (SCL, VPX)
PBG = (KNC, PFX)
QCP = (LRX, KQG)
NRC = (GPD, JMG)
PHH = (DGT, RLF)
XCH = (LJC, QMT)
VXJ = (KPL, SSC)
TNX = (BPM, BPM)
PTR = (VSD, PTP)
NDC = (DQN, DQN)
SVT = (RQV, BXN)
NTJ = (SHC, QCM)
SHM = (SNM, JKK)
TLD = (TTC, HQB)
MMN = (JNK, RRS)
NPC = (MTC, MXN)
NMF = (QBM, CTP)
CQX = (NRH, ZZZ)
BNT = (DRF, QNR)
BJZ = (CNH, NQS)
KFK = (XCT, PPG)
SDG = (TGF, FTC)
CBB = (HFV, LNX)
VFQ = (LVC, JCC)
LRF = (KLM, JGL)
TTC = (JLR, GFT)
PFH = (SHG, XTT)
RLT = (MLF, LMC)
XPJ = (JPL, BJZ)
PKQ = (BXM, QJK)
TNS = (GDR, DCF)
FKX = (PKG, QQL)
MJB = (HKH, JFD)
JTN = (JSM, QJH)
QTG = (NRN, KCF)
MPX = (CHR, TGC)
JKK = (CJT, PLN)
LKK = (DRC, HTP)
RXF = (KRJ, CRS)
QNC = (LFB, FQG)
RKQ = (DSR, XHQ)
LCX = (PGK, VDP)
KSG = (LLD, QXM)
RPK = (NJT, DLF)
KDM = (KSG, PLL)
TVP = (HTP, DRC)
DCB = (NKK, NKK)
DQN = (STJ, STJ)
JSH = (TRS, GKJ)
LDP = (XGS, LJK)
QRM = (LRF, KQH)
VGG = (NRH, NRH)
LLK = (VMH, PKT)
VSK = (PHH, NGQ)
JFB = (VLG, QNC)
BCL = (XKD, GLG)
RTF = (RKQ, DTG)
KPF = (GDT, XJD)
DHZ = (SNK, TPC)
LPC = (DCB, KCB)
KDF = (RGH, CCJ)
PLL = (QXM, LLD)
XHS = (FXM, LLM)
BHF = (JTX, XKN)
RRS = (DLK, LHV)
FFL = (HKS, NHB)
VRF = (QRB, VHB)
LSQ = (MRN, PJM)
SCD = (MXK, DBX)
SPD = (FXG, RDX)
CFM = (PQN, LFP)
QKK = (SPD, XNR)
LVC = (JJR, FSP)
RLV = (TRD, GHG)
HKK = (SSP, XNP)
JCC = (FSP, JJR)
JHT = (MPD, SCN)
RVP = (XVQ, LSQ)
HPQ = (GFB, MFL)
JRT = (VTN, SKP)
DTD = (TGB, BSF)
PKG = (SKX, DGB)
VMP = (RLG, JBP)
DSX = (RFF, PTN)
QRQ = (BJQ, XCH)
LLX = (VXC, MSL)
SVH = (DFS, TCK)
XNR = (RDX, FXG)
QKM = (LJK, XGS)
MMH = (BLG, NVN)
SKB = (DCB, KCB)
JXT = (KPF, DLH)
SVV = (BCV, VVT)
KLD = (MHM, PVJ)
QNN = (SVV, NQK)
FCX = (GFV, CHN)
BNS = (QBD, DDP)
SHP = (HML, CQH)
TJD = (TXL, CXT)
BQF = (FCP, DCQ)
MKX = (SNS, CCN)
JKF = (NPH, KGL)
LFB = (QFL, GVT)
DCQ = (PLJ, KND)
SVP = (VGX, JCR)
PGN = (XMT, MXG)
NVZ = (VRF, XLT)
VBR = (BDM, LXP)
GTX = (PHK, DSN)
BDX = (XHC, HQD)
JGX = (HGC, FBH)
BBL = (DFS, TCK)
KNT = (BBX, GMP)
TLP = (LXH, TKF)
TDS = (CBB, VPN)
CTD = (LTN, LTN)
HCG = (RRQ, GTQ)
VRG = (TTS, KQC)
RLC = (TLP, FQX)
FBH = (DBM, LCX)
SCP = (TVC, RBX)
CGC = (TBN, FVC)
JFG = (NQP, GDV)
BVM = (RLG, JBP)
DCF = (KNF, FCX)
BJV = (QXV, LQD)
QBD = (JBR, KLD)
QFG = (BBL, SVH)
RFF = (HPQ, KCD)
QJQ = (PRV, BVK)
FMC = (QHJ, GFG)
PXV = (STQ, VHK)
VVN = (XNC, BNS)
NHG = (DXM, KVJ)
SSP = (SGJ, GSK)
QMT = (JFG, XBK)
VRK = (NQK, SVV)
SNT = (DDG, RSG)
RRB = (BPG, CVQ)
DXQ = (JDQ, DSX)
FMP = (SHM, GSV)
VMF = (FJX, VBR)
NKJ = (GKP, SBS)
XGM = (FLR, MXS)
SKX = (NLH, RTG)
XMS = (FDP, PRK)
SPG = (PPG, XCT)
QNR = (MPX, SXC)
MDC = (BPM, CTR)
SMR = (TJT, HXC)
TBN = (FJS, TDS)
BGH = (NPF, HRT)
VDS = (XHS, PSX)
RBX = (CDJ, PBG)
VLC = (CQJ, GPP)
SVR = (GTX, HLC)
MDV = (DGL, SFJ)
GMB = (CSP, PRH)
QSP = (TBD, CFM)
GFQ = (PHH, NGQ)
HXG = (BDT, VRG)
PPG = (XDM, MMN)
MSH = (SHC, QCM)
CHR = (JXF, JNB)
RDX = (MTH, BGH)
VXC = (MSD, BFL)
DLP = (PXV, QQP)
MXP = (FQX, TLP)
TTQ = (TBD, CFM)
GHG = (HPF, NRK)
SNK = (BQF, CPH)
MGG = (STJ, QDH)
CCJ = (MBM, KNT)
NNL = (KBH, LKC)
LKD = (GKJ, TRS)
GFN = (LGT, LXK)
QBM = (XGM, SFV)
STJ = (CFV, CFV)
DSK = (RDP, NBQ)
TSC = (FKJ, DSK)
NSV = (LQB, TRJ)
FKF = (XGR, JXT)
DNX = (NTJ, MSH)
NLH = (JSH, LKD)
CFV = (TPC, SNK)
DRP = (VBR, FJX)
BDM = (SPR, RTF)
TGF = (FPC, CSK)
CNH = (VXD, LFX)
BFL = (RQP, RVP)
XHC = (GND, MDV)
CJJ = (RLT, QQB)
HPH = (XMM, NHL)
PRH = (FLN, BNM)
JCR = (THT, VCP)
VHK = (XDC, JFR)
NQP = (KXT, BJT)
CDJ = (KNC, PFX)
SCF = (DKC, QQQ)
JBR = (MHM, PVJ)
TPC = (BQF, CPH)
FDC = (LKJ, VDS)
KNC = (XCQ, VKJ)
VQM = (SHG, XTT)
KND = (QCS, TVN)
MDM = (GPL, DNX)
FJX = (LXP, BDM)
BDV = (XTB, NVZ)
LBM = (KFN, TGG)
XKC = (KBH, LKC)
QVF = (VMP, BVM)
SHG = (RBR, BHF)
DNB = (SVC, SSQ)
SCN = (JGG, BDV)
SXC = (TGC, CHR)
XSL = (KCJ, SVG)
TKF = (VLC, LVJ)
LKJ = (XHS, PSX)
VHX = (QMG, LCN)
HGC = (LCX, DBM)
MLN = (HFD, KVM)
XDM = (JNK, RRS)
RTK = (PKD, NPC)
QQQ = (DSL, FTV)
VJS = (DTF, VFQ)
LLM = (VVG, BNT)
MFM = (NHG, NQD)
NQK = (VVT, BCV)
NHN = (HPM, VCJ)
SKP = (NMQ, XHM)
HXC = (BVD, PFN)
LSK = (FQJ, KGC)
FPC = (GFX, MDQ)
STC = (RBF, PTM)
CTR = (BRD, KQZ)
BNQ = (SKB, LPC)
QQL = (SKX, DGB)
NHX = (RKX, HPH)
QHJ = (GRQ, BBP)
XCQ = (XPX, PGN)
HTV = (GTS, KBJ)
JXF = (DXQ, FBK)
JTR = (HTJ, PML)
JHB = (JSM, QJH)
CQF = (BDT, VRG)
GNQ = (QCT, QFG)
TQC = (TGB, BSF)
SFS = (SCP, QLZ)
MDQ = (MJD, XVS)
DLC = (TMM, DFM)
FLN = (RGV, SDN)
PVJ = (QTG, XGF)
JFR = (JTR, GHT)
PGK = (VVR, MHR)
TDP = (SSQ, SVC)
RLF = (RKP, SKK)
HJN = (NHB, HKS)
VJR = (TRJ, LQB)
VGX = (VCP, THT)
DSB = (PLL, KSG)
FTM = (VGX, JCR)
MHR = (LBM, NKF)
JFD = (CBP, HLJ)
HKH = (CBP, HLJ)
FDV = (QFH, JMK)
NHL = (RQG, JKF)
CQJ = (DHQ, NRC)
HVD = (SNS, CCN)
PLN = (QKM, LDP)
THT = (BCL, XDT)
FDP = (SCD, XCP)
TJC = (HHV, MVS)
QCM = (HKK, FQV)
TJQ = (QCT, QFG)
HFR = (KJH, PKF)
RQG = (NPH, KGL)
SRJ = (TNS, NPR)
LTR = (NKQ, PJG)
XST = (FVX, RGT)
MBM = (GMP, BBX)
KVM = (CBD, DBG)
MVS = (VRL, JVC)
SSC = (RPL, HBT)
QQP = (VHK, STQ)
CHQ = (SVG, KCJ)
BVD = (FMQ, JGX)
FNX = (NPC, PKD)
FJS = (CBB, VPN)
PLD = (FFL, HJN)
TVC = (CDJ, PBG)
DBX = (XJN, PTB)
MDK = (SQD, RGD)
JPL = (NQS, CNH)
VDG = (GKS, CJJ)
HQB = (GFT, JLR)
GQS = (VMF, DRP)
PST = (MKS, KXG)
XGS = (SHP, FPF)
XDJ = (VNX, PTR)
MHM = (QTG, XGF)
SHN = (SBS, GKP)
LFX = (FLF, NCQ)
BFX = (JNQ, MCT)
XHM = (RNQ, MDM)
LXN = (HJN, FFL)
HPJ = (JRT, GDQ)
NVN = (DTD, TQC)
KGL = (QJC, JQF)
MCT = (PBP, VDG)
QFH = (LPX, JNM)
FVC = (FJS, TDS)
DRL = (QBM, CTP)
LTJ = (MLX, NHX)
THB = (JTN, JHB)
SBX = (RPN, PKQ)
KMV = (RRQ, GTQ)
MNX = (LMH, RXH)
LKC = (TMH, MGF)
TMM = (BFX, PNS)
TMH = (XMS, GGT)
LPX = (QRM, MSV)
STN = (DRL, NMF)
RKP = (CHQ, XSL)
DNC = (HDG, VJS)
XMM = (JKF, RQG)
GFT = (LSM, NXT)
LSM = (SMR, PGC)
FKS = (XSJ, PMK)
MPD = (JGG, JGG)
DKC = (DSL, FTV)
HLC = (DSN, PHK)
KMS = (BJC, BFV)
NJT = (RFT, STN)
JSK = (RBF, RBF)
HLJ = (LGD, PTX)
QMG = (TLV, FMC)
GPL = (NTJ, MSH)
RQP = (XVQ, LSQ)
GGT = (FDP, PRK)
XKN = (JBK, SQN)
FVX = (MGN, GFN)
GST = (CRK, SCF)
MTK = (BFV, BJC)
CCN = (KMV, HCG)
TRS = (PDP, TQD)
NRN = (LBP, JHT)
GFG = (GRQ, BBP)
XBK = (NQP, GDV)
CXT = (QRV, PPH)
FQV = (SSP, XNP)
GFB = (NDC, TPM)
VXD = (NCQ, FLF)
XPX = (MXG, XMT)
SQD = (SRV, GGX)
GKP = (NFC, CGC)
AAA = (XBB, FGX)
KXR = (SHM, GSV)
DGB = (RTG, NLH)
PJM = (PNC, MNX)
QGV = (NPR, TNS)
CFB = (SLP, XQG)
FDJ = (TDV, MJB)
DSN = (KGF, SBX)
FLR = (FDL, SXH)
JGL = (QRQ, XLP)
JQN = (JTN, JHB)
MTH = (NPF, HRT)
PRK = (SCD, XCP)
VHA = (KLF, HXJ)
VVR = (NKF, LBM)
CQH = (VTD, KJK)
DRF = (MPX, SXC)
FDL = (LSK, HMP)
PFX = (XCQ, VKJ)
HPF = (XKC, NNL)
LXH = (LVJ, VLC)
SVC = (MXX, BNQ)
GFX = (XVS, MJD)
DGT = (SKK, RKP)
XKD = (KFK, SPG)
XJN = (BDK, QXQ)
KQH = (KLM, JGL)
VMH = (SKR, XFK)
CHN = (VSK, GFQ)
LHV = (DGK, XST)
HCF = (PKF, KJH)
CNF = (QHB, XPJ)
QCS = (SJM, KMC)
GXP = (QQL, PKG)
SBJ = (QJQ, KJN)
DHQ = (GPD, JMG)
VLG = (FQG, LFB)
GDQ = (VTN, SKP)
NMQ = (MDM, RNQ)
XKM = (KVM, HFD)
BNM = (SDN, RGV)
MLX = (RKX, HPH)
QJC = (LLK, BQH)
HML = (KJK, VTD)
SKK = (CHQ, XSL)
FQX = (TKF, LXH)
PKD = (MXN, MTC)
NQS = (LFX, VXD)
HBT = (CDP, MMH)
LRC = (DFM, TMM)
NXT = (SMR, PGC)
SXB = (XHD, SNT)
RBF = (VGG, VGG)
RXP = (GNQ, TJQ)
RVK = (DRP, VMF)"""

# data = """LLR

# AAA = (BBB, BBB)
# BBB = (AAA, ZZZ)
# ZZZ = (ZZZ, ZZZ)"""

# data = """LR

# 11A = (11B, XXX)
# 11B = (XXX, 11Z)
# 11Z = (11B, XXX)
# 22A = (22B, XXX)
# 22B = (22C, 22C)
# 22C = (22Z, 22Z)
# 22Z = (22B, 22B)
# XXX = (XXX, XXX)"""

import itertools
import re

data_split = data.splitlines()
directions = data_split[0]

re1 = re.compile(r"(\w+?) = \((\w+?), (\w+?)\)")
mapping = {}
for line in data_split[2:]:
    x = re.match(re1, line)
    mapping[x.group(1)] = (x.group(2), x.group(3))

### Part 1
# counter = 0
# current = "AAA"
# for direction in itertools.cycle(directions):
#     if current == "ZZZ":
#         break
#     counter += 1
#     if direction == "L":
#         current = mapping[current][0]
#     else:
#         current = mapping[current][1]

# print(counter)

### Part 2 slow
# def step(current, direction):
#     if direction == "L":
#         return mapping[current][0]
#     else:
#         return mapping[current][1]

# counter = 0
# current = [i for i in mapping if i.endswith("A")]
# for direction in itertools.cycle(directions):
#     if all(i.endswith("Z") for i in current):
#         break
#     counter += 1
#     current = [step(i, direction) for i in current]
#     # print(current)

# print(counter)



encoder = {j: i for i, j in enumerate(sorted(mapping, key=lambda x: x.endswith("Z"), reverse=True))}
decoder = {i: j for i, j in enumerate(sorted(mapping, key=lambda x: x.endswith("Z"), reverse=True))}
counter = 0
current = [encoder[i] for i in mapping if i.endswith("A")]
left = [encoder[mapping[i][0]] for i in mapping]
right = [encoder[mapping[i][1]] for i in mapping]
isleft = [1 if i == "L" else 0 for i in directions]

from pprint import pprint
pprint(current, compact=True)
pprint(left, compact=True)
pprint(right, compact=True)
pprint(isleft, compact=True)

# %load_ext cython
%%cython
cpdef based():
    cdef int[6] current = [72, 79, 93, 335, 743, 756]
    cdef int[798] left = [32, 111, 89, 683, 442, 686, 36, 744, 496, 775, 545, 521, 200, 159, 240, 656,
 730, 670, 654, 21, 492, 650, 272, 729, 557, 344, 98, 691, 48, 673, 51, 683,
 546, 398, 792, 396, 427, 680, 794, 753, 56, 405, 146, 332, 6, 116, 616, 607,
 180, 224, 534, 20, 652, 690, 636, 336, 250, 591, 449, 377, 247, 737, 379, 155,
 526, 161, 588, 357, 682, 321, 760, 242, 130, 677, 741, 632, 327, 591, 544, 259,
 568, 342, 623, 422, 411, 267, 362, 790, 334, 303, 541, 437, 730, 156, 157, 746,
 452, 202, 715, 283, 721, 759, 60, 443, 206, 510, 17, 474, 381, 503, 256, 124,
 697, 237, 336, 447, 667, 123, 634, 466, 277, 704, 134, 135, 296, 215, 38, 265,
 626, 165, 632, 569, 117, 498, 29, 70, 132, 543, 701, 43, 506, 331, 219, 165,
 226, 355, 137, 306, 524, 52, 194, 659, 36, 153, 616, 18, 579, 354, 421, 76,
 770, 304, 120, 64, 464, 41, 711, 63, 439, 387, 784, 554, 460, 530, 703, 271,
 49, 249, 733, 264, 711, 323, 766, 102, 174, 129, 674, 587, 125, 748, 248, 527,
 255, 555, 231, 674, 600, 503, 487, 62, 692, 440, 13, 520, 738, 413, 187, 664,
 9, 170, 11, 468, 382, 684, 531, 776, 373, 209, 17, 378, 243, 661, 105, 428,
 613, 386, 714, 66, 35, 30, 302, 115, 608, 726, 398, 15, 435, 494, 782, 58, 546,
 356, 783, 184, 717, 511, 57, 728, 773, 407, 688, 128, 569, 434, 18, 133, 684,
 476, 679, 77, 160, 489, 9, 401, 143, 270, 493, 249, 698, 261, 771, 142, 176,
 389, 74, 304, 747, 581, 653, 768, 637, 484, 95, 394, 372, 85, 570, 796, 721,
 20, 141, 208, 342, 744, 103, 444, 31, 489, 487, 543, 225, 517, 769, 114, 572,
 285, 779, 441, 445, 716, 561, 499, 478, 659, 449, 131, 539, 358, 508, 708, 444,
 578, 238, 479, 359, 400, 693, 30, 301, 434, 676, 485, 49, 22, 671, 34, 356,
 315, 483, 540, 662, 253, 276, 391, 514, 195, 312, 560, 10, 110, 642, 23, 370,
 384, 758, 665, 281, 397, 409, 404, 749, 286, 648, 438, 291, 277, 80, 363, 313,
 92, 497, 293, 134, 85, 251, 363, 757, 645, 337, 95, 700, 86, 82, 294, 497, 433,
 107, 207, 323, 590, 240, 204, 766, 110, 340, 338, 12, 437, 243, 67, 21, 415,
 65, 260, 564, 234, 759, 576, 47, 575, 271, 461, 169, 230, 599, 176, 680, 16,
 285, 470, 651, 109, 733, 551, 172, 343, 38, 491, 213, 641, 233, 720, 432, 252,
 143, 565, 732, 685, 414, 234, 770, 395, 779, 767, 430, 193, 558, 436, 121, 330,
 361, 62, 377, 50, 332, 126, 283, 319, 185, 458, 341, 371, 522, 152, 716, 100,
 738, 33, 216, 532, 127, 516, 352, 553, 369, 552, 73, 123, 436, 447, 383, 687,
 481, 108, 514, 786, 226, 239, 178, 351, 94, 15, 646, 119, 455, 574, 385, 578,
 607, 369, 87, 763, 412, 321, 227, 238, 501, 68, 677, 538, 584, 127, 274, 97,
 587, 499, 467, 270, 626, 99, 347, 329, 142, 510, 615, 362, 219, 386, 403, 594,
 742, 751, 571, 658, 549, 425, 338, 35, 675, 173, 451, 585, 654, 496, 317, 246,
 346, 395, 325, 609, 67, 629, 754, 124, 519, 788, 346, 762, 488, 565, 667, 118,
 7, 114, 531, 572, 380, 384, 177, 120, 402, 438, 588, 495, 231, 620, 739, 725,
 167, 417, 712, 638, 657, 157, 125, 590, 717, 687, 488, 605, 627, 599, 775, 724,
 198, 180, 63, 118, 471, 203, 764, 54, 348, 388, 542, 451, 723, 431, 139, 65,
 789, 212, 168, 106, 521, 188, 140, 781, 673, 256, 765, 795, 34, 479, 532, 282,
 199, 740, 353, 527, 158, 109, 325, 314, 216, 508, 284, 706, 44, 424, 630, 757,
 88, 710, 214, 254, 311, 450, 646, 596, 113, 113, 697, 663, 778, 178, 477, 445,
 457, 77, 463, 314, 289, 351, 420, 265, 728, 295, 154, 242, 315, 583, 299, 53,
 406, 412, 454, 585, 768, 741, 790, 345, 713, 529, 71, 486, 98, 424, 28, 144,
 264, 290, 644, 468, 469, 785, 160, 708, 675, 564, 784, 423, 327, 227, 155, 707,
 690, 533, 440, 699, 672, 209, 490, 714, 537, 354, 54, 212, 750, 245, 253, 795,
 175, 133, 402, 100, 658, 374, 306, 248, 339, 703, 222, 312, 199, 584, 105, 522,
 400, 197, 61, 145, 272, 302, 403, 366, 69, 308, 81, 27, 82, 760, 473, 423, 173,
 457, 48, 171, 280, 425, 619, 627, 597, 24, 326, 40, 787, 410, 223, 169, 258,
 443, 251, 376, 43, 267, 624, 517, 204, 390, 33, 593, 668, 288, 282, 442, 211,
 672, 604, 217, 689, 122, 59, 537, 92, 441, 633, 573]
    cdef int[798] right =[686, 222, 749, 797, 164, 32, 112, 528, 718, 91, 281, 78, 353, 258, 42, 172,
 719, 340, 287, 426, 239, 651, 509, 194, 371, 720, 399, 781, 70, 138, 474, 797,
 556, 536, 637, 352, 435, 680, 372, 701, 767, 609, 526, 257, 11, 553, 320, 507,
 180, 401, 410, 393, 117, 183, 765, 513, 374, 416, 350, 772, 213, 463, 641, 316,
 146, 715, 558, 486, 415, 635, 235, 236, 329, 541, 210, 548, 419, 416, 167, 723,
 645, 589, 326, 27, 389, 55, 278, 576, 520, 291, 677, 559, 719, 12, 640, 126,
 203, 301, 161, 678, 621, 535, 620, 547, 129, 735, 614, 51, 175, 503, 136, 577,
 322, 707, 513, 196, 500, 694, 469, 725, 90, 69, 147, 81, 13, 693, 244, 300,
 734, 279, 548, 166, 652, 53, 154, 48, 665, 14, 753, 43, 555, 102, 162, 279,
 736, 223, 58, 563, 483, 158, 729, 263, 112, 630, 320, 628, 345, 360, 776, 751,
 19, 777, 480, 317, 461, 473, 221, 83, 477, 373, 625, 337, 261, 688, 504, 181,
 455, 598, 349, 696, 221, 298, 643, 331, 700, 206, 610, 482, 368, 128, 586, 229,
 193, 506, 446, 610, 642, 75, 148, 727, 676, 305, 296, 334, 328, 168, 145, 747,
 37, 184, 6, 780, 286, 297, 163, 421, 387, 612, 614, 370, 150, 633, 292, 131,
 361, 472, 793, 430, 618, 462, 141, 619, 782, 533, 398, 592, 427, 740, 608, 137,
 556, 567, 638, 170, 611, 471, 293, 151, 662, 699, 530, 748, 166, 647, 628, 518,
 297, 458, 80, 669, 681, 655, 37, 224, 774, 365, 648, 598, 538, 460, 108, 45,
 273, 411, 404, 777, 664, 246, 712, 149, 792, 274, 367, 778, 794, 606, 724, 225,
 621, 393, 302, 467, 589, 528, 71, 309, 433, 655, 148, 14, 796, 269, 414, 201,
 4, 512, 429, 408, 46, 716, 597, 475, 122, 263, 350, 428, 754, 140, 508, 205,
 309, 84, 39, 448, 16, 96, 215, 462, 202, 647, 692, 347, 455, 97, 519, 34, 567,
 791, 524, 605, 773, 709, 417, 185, 191, 629, 465, 121, 785, 523, 600, 397, 378,
 566, 786, 132, 545, 23, 106, 74, 89, 382, 493, 562, 303, 90, 679, 8, 762, 525,
 324, 57, 147, 606, 666, 8, 649, 568, 554, 367, 174, 380, 702, 516, 324, 31,
 575, 94, 298, 761, 42, 333, 643, 523, 670, 338, 156, 437, 150, 660, 426, 682,
 453, 217, 218, 2, 535, 790, 549, 107, 181, 464, 752, 713, 101, 273, 3, 359,
 512, 624, 650, 189, 349, 348, 656, 252, 244, 390, 247, 379, 330, 344, 450, 343,
 143, 565, 7, 73, 769, 234, 19, 186, 429, 56, 66, 255, 588, 268, 560, 233, 613,
 727, 772, 214, 257, 746, 678, 552, 391, 476, 152, 557, 275, 341, 601, 456, 328,
 617, 364, 745, 375, 294, 396, 116, 262, 319, 685, 694, 268, 196, 188, 639, 615,
 771, 191, 758, 736, 492, 731, 695, 207, 592, 582, 61, 49, 198, 750, 84, 507,
 262, 295, 604, 179, 321, 318, 39, 788, 431, 541, 698, 192, 375, 484, 22, 482,
 475, 208, 365, 734, 583, 485, 130, 45, 735, 481, 278, 162, 472, 25, 495, 28,
 76, 366, 755, 47, 602, 622, 618, 502, 220, 228, 392, 287, 718, 64, 581, 459,
 186, 505, 405, 660, 195, 539, 577, 671, 501, 459, 313, 26, 307, 500, 705, 732,
 201, 163, 572, 86, 566, 254, 480, 550, 562, 558, 594, 446, 60, 689, 466, 544,
 276, 653, 783, 311, 640, 368, 761, 611, 639, 26, 540, 241, 101, 91, 570, 574,
 5, 83, 705, 511, 452, 88, 595, 551, 299, 24, 228, 259, 68, 668, 453, 406, 266,
 413, 409, 78, 383, 358, 691, 138, 136, 636, 310, 1, 448, 745, 580, 190, 494,
 200, 229, 52, 189, 505, 515, 364, 0, 40, 59, 288, 182, 153, 649, 764, 787, 50,
 177, 657, 432, 582, 171, 722, 722, 322, 490, 394, 731, 439, 46, 104, 669, 737,
 515, 376, 695, 308, 300, 151, 87, 29, 236, 791, 99, 388, 498, 789, 179, 644,
 392, 149, 210, 576, 579, 230, 573, 103, 357, 399, 182, 742, 197, 696, 593, 454,
 780, 634, 10, 681, 205, 502, 218, 625, 631, 419, 318, 316, 237, 183, 726, 305,
 407, 603, 612, 663, 793, 232, 360, 54, 266, 385, 339, 709, 795, 381, 518, 550,
 456, 755, 250, 563, 586, 245, 504, 111, 465, 190, 192, 292, 275, 96, 144, 119,
 187, 509, 141, 25, 571, 704, 420, 135, 422, 702, 235, 41, 631, 220, 104, 70,
 596, 211, 602, 115, 241, 561, 542, 623, 284, 710, 534, 355, 752, 159, 547, 666,
 289, 418, 55, 470, 269, 333, 491, 617, 290, 139, 44, 580, 164, 280, 603, 763,
 260, 739, 478, 706, 232, 525, 441, 661, 529]
    cdef int[293] isleft = [1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1,
 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1,
 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0,
 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1,
 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0,
 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0,
 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 1,
 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0,
 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1,
 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0,
 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0,
 0, 1, 1, 0, 0, 0, 0]
    cdef int i_isleft = 0
    cdef long counter = 0
    cdef int i
    while True:
        for i in current:
            if i > 5:
                break
        else:
            return counter
        for i in range(len(current)):
            if isleft[i_isleft]:
                current[i] = left[current[i]]
            else:
                current[i] = right[current[i]]
        counter += 1
        i_isleft = (i_isleft + 1) % 293
        if counter % 10000000 == 0:
            print(counter)

based()

current = [1,2,3]
cdef int i = 3
print(i)
# cdef int[len(current)] current_c
# for i in range(len(current)):
#     current_c[i] = current[i]


# cdef int[len(mapping)] left
# cdef int[len(mapping)] right
# for i in range(len(mapping)):
#     left[i] = encoder[mapping[decoder[i]][0]]
#     right[i] = encoder[mapping[decoder[i]][1]]

# print(left)